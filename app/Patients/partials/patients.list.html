<div cg-busy="myPromise"></div>
<form>
    <div class="row">
        <div class="form-group col-md-4">
            <button type="button" class="btn btn-primary" ng-click="createPatientProfile()" >
                <i class="fa fa-plus"></i>
                Create Patient Profile
            </button>
        </div>

        <div class="form-group col-md-4 pull-right">
            <div class="input-group">
                <input type="text" ng-keydown="$event.which === 13 && searchByMobileNumber()" class="form-control" placeholder="Search by Patient's Mobile Number.." ng-model="patient.search.mobilenumber" id="patientsearchmobilenumber">
                <span class="input-group-btn">
                    <button class="btn btn-default" type="button" ng-click="searchByMobileNumber()"><span class="glyphicon glyphicon-search"></span></button>
                </span>
            </div><!-- /input-group -->
        </div>
    </div>
    <div class="row">
        <div class="page-header text-muted" ng-show="showSearchResults">
            <h4> Search Results:</h4>
        </div>
        <div class="alert alert-danger" role="alert" ng-show="showAlert">
            {{alertMessage}}
        </div>
        <table class="table table-hover table-condensed table-vcenter" ng-show="showSearchResults">
            <thead>
                <tr>
                    <th>
                        <a href="" ng-click="sortSearchResultsType = 'firstName'; sortSearchResultsReverse = !sortSearchResultsReverse">
                            Name
                            <span ng-show="sortSearchResultsType == 'firstName' && !sortSearchResultsReverse" class="fa fa-caret-down"></span>
                            <span ng-show="sortSearchResultsType == 'firstName' && sortSearchResultsReverse" class="fa fa-caret-up"></span>
                        </a>
                    </th>                     
                    <th>
                        <a href="" ng-click="sortSearchResultsType = 'dob'; sortSearchResultsReverse = !sortSearchResultsReverse">
                            Date of Birth
                            <span ng-show="sortSearchResultsType == 'dob' && !sortSearchResultsReverse" class="fa fa-caret-down"></span>
                            <span ng-show="sortSearchResultsType == 'dob' && sortSearchResultsReverse" class="fa fa-caret-up"></span>
                        </a>
                    </th> 
                    <th>
                        <a href="" ng-click="sortSearchResultsType = 'sex'; sortSearchResultsReverse = !sortSearchResultsReverse">
                            Gender
                            <span ng-show="sortSearchResultsType == 'sex' && !sortSearchResultsReverse" class="fa fa-caret-down"></span>
                            <span ng-show="sortSearchResultsType == 'sex' && sortSearchResultsReverse" class="fa fa-caret-up"></span>
                        </a>
                    </th> 
                    <th>
                        <a href="" ng-click="sortSearchResultsType = 'mobile'; sortSearchResultsReverse = !sortSearchResultsReverse">
                            Mobile Number
                            <span ng-show="sortSearchResultsType == 'mobile' && !sortSearchResultsReverse" class="fa fa-caret-down"></span>
                            <span ng-show="sortSearchResultsType == 'mobile' && sortSearchResultsReverse" class="fa fa-caret-up"></span>
                        </a>
                    </th> 
                    <th>
                        <a href="" ng-click="sortSearchResultsType = 'email'; sortSearchResultsReverse = !sortSearchResultsReverse">
                            Email Id
                            <span ng-show="sortSearchResultsType == 'email' && !sortSearchResultsReverse" class="fa fa-caret-down"></span>
                            <span ng-show="sortSearchResultsType == 'email' && sortSearchResultsReverse" class="fa fa-caret-up"></span>
                        </a>
                    </th> 
                    <th>
                        <a href="" ng-click="sortSearchResultsType = 'address.addressLine1'; sortSearchResultsReverse = !sortSearchResultsReverse">
                            Address
                            <span ng-show="sortSearchResultsType == 'address.addressLine1' && !sortSearchResultsReverse" class="fa fa-caret-down"></span>
                            <span ng-show="sortSearchResultsType == 'address.addressLine1' && sortSearchResultsReverse" class="fa fa-caret-up"></span>
                        </a>
                    </th> 
                    <th>
                        <a href="" ng-click="sortSearchResultsType = 'relation'; sortSearchResultsReverse = !sortSearchResultsReverse">
                            Relationship
                            <span ng-show="sortSearchResultsType == 'relation' && !sortSearchResultsReverse" class="fa fa-caret-down"></span>
                            <span ng-show="sortSearchResultsType == 'relation' && sortSearchResultsReverse" class="fa fa-caret-up"></span>
                        </a>
                    </th> 
                </tr>
            </thead>
            <tbody>
                <tr ng-repeat="patientObjSearch in searchPatientResults| orderBy:sortSearchResultsType:sortSearchResultsReverse"> 
                    <!-- Hyperlink to Profile Page using unique Patient Id -->
                    <td>
                        <a href="#/patients/edit/{{patientObjSearch.patientId}}" class="btn btn-link" role="button">
                            <img ng-src="{{patientObjSearch.profileImageURL}}" class="img-circle" width="40" height="40">
                        </a>
                        <a href="#/patients/edit/{{patientObjSearch.patientId}}" uib-tooltip="View Patient Profile"> {{getFullName(patientObjSearch)}} </a>
                    </td>
                    <!-- End Hyperlink -->
                    <td>{{patientObjSearch.dob| date:'MM/dd/yyyy'}}</td>
                    <td>{{patientObjSearch.sex}}</td> 
                    <td>{{patientObjSearch.mobile}}</td> 
                    <td>{{patientObjSearch.email}}</td> 
                    <td>{{getFullAddress(patientObjSearch)}}</td> 
                    <td>{{patientObjSearch.relation}}</td> 
                </tr>
            </tbody>
        </table>
    </div>

    <div class="row">
        <div class="page-header text-muted">
            <h4> Your Recent Patients List:</h4>
        </div>
        <table class="table table-hover table-condensed table-vcenter">
            <thead>
                <tr>
                    <th>
                        <a href="" ng-click="sortType = 'firstName'; sortReverse = !sortReverse">
                            Name
                            <span ng-show="sortType == 'firstName' && !sortReverse" class="fa fa-caret-down"></span>
                            <span ng-show="sortType == 'firstName' && sortReverse" class="fa fa-caret-up"></span>
                        </a>
                    </th>                     
                    <th>
                        <a href="" ng-click="sortType = 'dob'; sortReverse = !sortReverse">
                            Date of Birth
                            <span ng-show="sortType == 'dob' && !sortReverse" class="fa fa-caret-down"></span>
                            <span ng-show="sortType == 'dob' && sortReverse" class="fa fa-caret-up"></span>
                        </a>
                    </th> 
                    <th>
                        <a href="" ng-click="sortType = 'sex'; sortReverse = !sortReverse">
                            Gender
                            <span ng-show="sortType == 'sex' && !sortReverse" class="fa fa-caret-down"></span>
                            <span ng-show="sortType == 'sex' && sortReverse" class="fa fa-caret-up"></span>
                        </a>
                    </th> 
                    <th>
                        <a href="" ng-click="sortType = 'mobile'; sortReverse = !sortReverse">
                            Mobile Number
                            <span ng-show="sortType == 'mobile' && !sortReverse" class="fa fa-caret-down"></span>
                            <span ng-show="sortType == 'mobile' && sortReverse" class="fa fa-caret-up"></span>
                        </a>
                    </th> 
                    <th>
                        <a href="" ng-click="sortType = 'email'; sortReverse = !sortReverse">
                            Email Id
                            <span ng-show="sortType == 'email' && !sortReverse" class="fa fa-caret-down"></span>
                            <span ng-show="sortType == 'email' && sortReverse" class="fa fa-caret-up"></span>
                        </a>
                    </th> 
                    <th>
                        <a href="" ng-click="sortType = 'address.addressLine1'; sortReverse = !sortReverse">
                            Address
                            <span ng-show="sortType == 'address.addressLine1' && !sortReverse" class="fa fa-caret-down"></span>
                            <span ng-show="sortType == 'address.addressLine1' && sortReverse" class="fa fa-caret-up"></span>
                        </a>
                    </th> 
                    <th>
                        <a href="" ng-click="sortType = 'relation'; sortReverse = !sortReverse">
                            Relationship
                            <span ng-show="sortType == 'relation' && !sortReverse" class="fa fa-caret-down"></span>
                            <span ng-show="sortType == 'relation' && sortReverse" class="fa fa-caret-up"></span>
                        </a>
                    </th>                   
                </tr>
            </thead>
            <tbody>
                <tr ng-repeat="patientObj in patientList| orderBy:sortType:sortReverse"> 
                    <!-- Hyperlink to Profile Page using unique Patient Id -->
                    <td>
                        <a href="#/patients/edit/{{patientObj.patientId}}" class="btn btn-link" role="button">
                            <img ng-src="{{patientObj.profileImageURL}}" class="img-circle" width="40" height="40">
                        </a>
                        <a href="#/patients/edit/{{patientObj.patientId}}" uib-tooltip="View Patient Profile"> {{getFullName(patientObj)}} </a>
                    </td>
                    <!-- End Hyperlink -->
                    <td>{{patientObj.dob| date:'MM/dd/yyyy'}}</td>
                    <td>{{patientObj.sex}}</td> 
                    <td>{{patientObj.mobile}}</td> 
                    <td>{{patientObj.email}}</td> 
                    <td>{{getFullAddress(patientObj)}}</td> 
                    <td>{{patientObj.relation}}</td> 
                </tr>
            </tbody>
        </table>
    </div>
</form>